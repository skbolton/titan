# Configurationh for prompt
if [ -f $ZDOTDIR/promptrc ]; then
    source $ZDOTDIR/promptrc
fi

# Configuration for path variable (varies between mac and arch)
if [ -f $ZDOTDIR/pathrc ]; then
    source $ZDOTDIR/pathrc
fi

source $ZSH/oh-my-zsh.sh

alias v="nvim"
alias aqua="Asciiquarium"

# Task warrior tooling
alias t="task"
alias tap="task context personal"
alias taw="task context work"
alias chore="task add +personal +chore" 
alias d="delta"
alias l="hledger"
alias lworth="hledger bs --tree -2 --real -V"
alias ltrue="hledger balance --tree --real --empty"
alias lbalance="hledger balance --tree --auto --empty"
alias ledit="v $LEDGER_FILE"

# use exa for ls
alias ls='exa -al --icons --color=always --group-directories-first'
alias la='exa -a --icons --color=always --group-directories-first'
alias ll='exa -l --icons --color=always --group-directories-first'
alias lt='exa -aT --icons --color=always --group-directories-first'


tickle () {
    task $@ modify wait:soww
}

work () {
  if [ $# -eq 0 ]; then
    # are we in the work context?
    local context=$(task _get rc.context)
    echo $context
    if [ -z "${context}" ] && [ "${context}" = "work" ]; then
      task
    else
      task +work
    fi
  else
    task add +work $@
  fi
}

delta() {
  if [ "$1" = "launch" ]; then
    tmuxinator start $2
  fi
  
  if [ "$1" = "l" ]; then
    tmuxinator start $2
  fi

  if [ "$1" = "new" ]; then
    tmuxinator start launch name=${PWD##*/} root=$(pwd)
  fi
}

bench() {
  dir="$HOME/Documents/Wolf/bench.md"
  if [ $# -eq 0 ]
  then
    while read line
      do
        echo "$line" >> $dir
      done < "${1:-/dev/stdin}"
  else
    echo $@ >> $dir
  fi

}

launch() {
  # since I override ls for myself need to call original directly
  session_name=$({ command ls ~/Repos; echo "titan" } | sk) 
  if [ $session_name = "titan" ]; then
    smug start $session_name 2>/dev/null || default_tmux_template titan ~/titan
  else
    smug start $session_name 2>/dev/null || default_tmux_template $session_name ~/Repos/$session_name
  fi
}

default_tmux_template() {
  session_name=$(echo $1 | tr '-' ' ' | tr '[:lower:]' '[:upper:]')
  root=$2

  # Check existing session and switch into it
  if tmux has-session -t $session_name 2>/dev/null; then
    if [ -n "${TMUX:-}" ]; then
        tmux switch-client -t $session_name
        exit 0
    else
      tmux attach-session -t $session_name
      exit 0
    fi
  fi

  tmux new -d -s $session_name -n " " -c $root nvim
  tmux new-window -d -n " " -c $root
  tmux a -t $session_name
}

title="A NEW BATTLE AWAITS, GUARDIAN"
printf "%*s\n" $(((${#title}+$COLUMNS)/2)) "$title"

. $HOME/.asdf/asdf.sh
. $HOME/.asdf/completions/asdf.bash
eval "$(direnv hook zsh)"

gpgconf --launch gpg-agent

# The next line updates PATH for the Google Cloud SDK.
if [ -f '/home/orlando/google-cloud-sdk/path.zsh.inc' ]; then . '/home/orlando/google-cloud-sdk/path.zsh.inc'; fi

# The next line enables shell command completion for gcloud.
if [ -f '/home/orlando/google-cloud-sdk/completion.zsh.inc' ]; then . '/home/orlando/google-cloud-sdk/completion.zsh.inc'; fi
